\chapter{Evoluèné algoritmy}\label{ea}
% Odporucana literatura:
% Goldberg - Genetic Algorithms in Search, Optimization and Machine Learning.
% Hynek - Geneticke algoritmy a geneticke programovanie.

% TODO:
% - geneticke operatory - doplnit, hlavne aj sposoby mutacie pri permutacnom kodovani jedicov
% - pri krizeni spomenut CGP - kartezske geneticke programovanie, pri ktorom
%   sa pouziva iba mutacia
% - evolucne strategie - nerobit ako samostatnu kapitolu, ale nadviazat
% - slovo klasifikacia ok ??
% - ujednotit si zvyraznovanie dolezitych pojmov - asi lepsie pomocou \emph ako \uvoz
% - obrazok ruletovej slekcie ???


Charles Darwin bol Anglièan, syn významného lekára.
Vy¹tudoval teológiu, po ¹túdiu sa zaoberal geologickými formáciami
v~horách Walesu. Koncom roka 1831 v¹ak odi¹iel na~5\mbox{-}roè\-nú výskumnú cestu okolo sveta.
Loï HMS Beagle ho zaviedla aj na~Galapágy, ekvádorské súostrovie 19 sopeèných ostrovov
vo~východnej èasti Tichého oceánu, kde zhroma¾dil podµa jeho slov najcennej¹iu èas»
prírodovedeckého materiálu, ktorý pou¾il vo~svojom najväè¹om diele
publikovanom v~roku 1859\,--\,{\it O~vzniku druhov prírodným výberom alebo
uchovávanie prospe¹ných plemien v~boji o~¾ivot} \cite{darwin_o_povode}.
Hlavou plnou prírodovedných informácií, získaných z~okru¾nej plavby okolo sveta,
v òom vrhá ucelený pohµad na~vývoj druhov oslobodený od~spi\-ri\-tua\-lity a~nábo¾enských
predstáv svojej a~predchádzajúcich dôb.
Darwin vysvetµuje vznik rôznych druhov organizmov
na~základe prirodzeného výberu, teda schopnosti pre¾i» len tých naj\-schop\-nej¹ích.
% citacia darwina?
Významným argumentom pre~jeho teóriu boli aj stratigrafické\footnote{
Stratigrafia je geologický vedný obor, který ¹tuduje vek sedimentárnych vrstiev hornín.}
výsledky geológa Charlesa Lyella,
ktoré podporovali rodiacu sa evoluènú teóriu v~oblasti \uvoz{èasovej zlo¾itosti}.
Aplikované princípy klasickej evoluènej teórie s~mnohými \uvoz{vylep¹eniami}
hrajú význam\-nú úlohu vo~fonde vedomostí µudstva.


% GA 1973, ES 1964, EP 1962, GP 1989
Evoluèné algoritmy (EA), ktoré sú postavené na~my¹lienkach evoluènej teórie,
zaèali vznika» u¾ v~50-tych rokoch 20. storoèia.
Výraznej¹í záujem v¹ak nastal a¾ pribli¾ne o~30~ro\-kov neskôr,
kedy David Goldberg významne roz¹íril prácu Johna Hollanda 
o~genetických algoritmoch (z~roku 1975 \cite{holland1975}) v~práci publikovanej v~roku 1989 \cite{goldberg_ga_89}.
Znaèným impulzom pre popularizáciu EA bola prvá väè¹ia práca
o~genetickom programovaní, ktorej autorom je John Koza \cite{koza_1}.




% BIOLOGICKE POJMY V EA KONTEXTE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Biologické pojmy v kontexte evoluèných algoritmov}

Vo~zvy¹ku tejto práce sa budú vyskytova» pojmy pochádzajúce z~biológie,
no sémantika nie v¹etkých je zhodná so~sémantikou v~kontexte EA. 
Pre ujasnenie pojmov je uvedený ich krátky prehµad.

Medzi základné pojmy Darwinovej evoluènej teórie patrí populácia.
Populácia je mno¾ina jedincov, ktorí sú reprezentovaní svojím genetickým materiálom.
V~tejto práci budú voµne zamieòané pojmy genetický materiál, genóm a~chromozóm,
aj keï z~pohµadu biológie tieto pojmy nie sú rovnocenné.
Genotyp je vlastné zakódovanie genetickej informácie do~urèitej ¹truktúry.
Spôsob, akým sa genotyp v~danom prostredí interpretuje,
ako dob\-re rie¹i nastolený problém, sa nazýva fenotyp.
Jedinec s~rovnakým genotypom mô¾e ma» v~inom prostredí odli¹nú schopnos» pre¾itia,
inými slovami, odli¹né prostredie spôsobí odli¹nú interpretáciu genotypu na~fenotyp.
Genetický materiál sa skladá z~lineárne usporiadaných génov,
v~kontexte EA jeden gén kóduje jednu vlastnos».
Konkrétna vlastos», hodnota génu, sa nazýva alela.
V~rámci poèítaèovej terminológie mô¾eme poveda», ¾e ka¾dý gén reprezentuje
urèitý dátový typ a~alely sú hodnotami daného dátového typu, génu.



% ZARADENIE EVOLUCNYCH ALGORITMOV
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Klasifikácia evoluèných algoritmov}
% TODO: rozsirit !!! - wut??

Existujú problémy, ktorých exaktný model sa nedá, nevieme alebo je veµmi
nároèné zostavi», a~navy¹e poèet rie¹ení
daného problému, resp. stavový priestor úlohy je obrovský.
Kvôli takýmto problémom vznikla nová vetva prístupov k rie¹eniu úloh oznaèovaná pojmom {\it softcomputing}.
Ide o spôsob rie¹enia problémov \uvoz{s~rozumom},
teda nie hrubou (hard) silou ako je to prípade klasických algoritmov
na~prehµadávanie stavového priestoru (napr. BFS, DFS).
Softcomputing rie¹i problémy pomocou urèitej heuristiky resp. heuristickej funkcie, ktorou
algoritmus \uvoz{myslí}. Potrebné je doda», ¾e metódy softcomputingu väè¹inou nenájdu
najlep¹ie rie¹enie, ale len suboptimálne, ktoré v¹ak takmer v¾dy postaèuje.
Obrázok~\ref{obr:ea_classification} zobrazuje zasadenie evoluèných algoritmov 
do~kontextu v¹etkých významných optimalizaèných techník.

Evoluèné algoritmy sú spoloèným vyjadrením pre~mno¾inu moderných matematických
postupov, ktoré vyu¾ívajú modely evoluèných procesov v~prírode zalo¾ených na~Darwinovej evoluènej
teórii popísanej na~zaèiatku tejto kapitoly.
Jednotlivé rie¹enia, ktoré tvoria populáciu, sa vyvíjajú na~základe klasických evoluèných a~genetických
operátorov ako je selekcia, krí¾enie èi mutácia.
EA stavajú a~súèasne aj padajú na~fitness funkcii, ktorá definuje schopnos» jedinca pre¾i» v~danom
prostredí resp. schopnos» rie¹enia rie¹i» daný problém.
Evoluèné algoritmy sú v~poslednej dobe veµmi roz¹írené. 
Príli¹ná popularizácia so~sebou v¹ak priná¹a aj nerealistické oèakávania.
Podobne ako evoluèné algoritmy, tak v¹eobecne aj~v¹etky optimalizaèné techniky nefungujú
ako univerzálne metódy, ale ka¾dá z~nich sa hodí na~inú oblas» problémov.
Zisti», ktorá technika je najlep¹ia, prípadne s~akými parametrami, 
je u¾ úlohou in¾inirskeho návrhu.

Podstatným rozdielom oproti klasickým optimalizaèným metódam je práca nie s~jedným, ale
s~mno¾inou rie¹ení, na~ktorú je mo¾no aplikova» genetické a~iné operátory.
Princíp evolúcie jednotlivých rie¹ení v rámci populácie popisuje nasledovná
v¹eobecná schéma evoluèného algoritmu \cite{hynek_ga_gp}:


\begin{enumerate}
	\item Vynuluj hodnotu poèítadla generácii $t=0$.
	\item Náhodne vygeneruj poèiatoènú populáciu $P(0)$.
	\item Vypoèítaj ohodnotenie ($fitness$) ka¾dého jedinca v poèiatoènej populácii $P(0)$.
	\item Vyber dvojice jedincov z populácie $P(t)$ a vytvor ich potomkov $P'(t)$.
	\item Vytvor novú populáciu $P(t+1)$ z pôvodnej populácie $P(t)$ a mno¾iny potomkov $P'(t)$.
	\item Zväè¹i hodnotu poèítadla generácii o jedna $(t:=t+1)$.
	\item Vypoèítaj ohodnotenie ($fitness$) ka¾dého jedinca v populácii $P(t)$.
	\item Ak je $t$ rovné maximálnemu poètu generácii alebo je splnené iné ukonèovacie kritérium, vrá» 
	ako výsledok populáciu $P(t)$; inak pokraèuj krokom èíslo 4.
\end{enumerate}



\begin{figure}[h]
\begin{center}
  \scalebox{0.5}{\includegraphics{fig/ea/optim_methods.jpg}}
  \caption{Klasifikácia evoluèných algoritmov v kontexte optimalizaèných techník.
  Softcomputing spadá medzi stochastické heuristické metódy.}
  \label{obr:ea_classification}
\end{center}
\end{figure}



% EVOLUCNE STRATEGIE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Evoluèné stratégie}

Keï v~roku 1963 zaèali Hans-Paul Schwefel a~Ingo Rechenberg na~Technickej univerzite
v~Berlíne s~napodobòovaním vývoja v~prírode, boli presvedèení, ¾e ich metóda najlep¹ie
aproximuje evolúciu v~¾ivej prírode.
Preto svoju metódu nazvali, celkom v¹eobecne, \emph{evoluèné stratégie} (ES).
Postupom èasu sa v¹ak ukázalo, ¾e tento spôsob rie¹i len urèitý typ úloh, hlavne
v~stavebnom a~strojnom in¾inierstve.
Genetické algoritmy nie sú teda podradené evoluèným stratégiam, ako sa domnievali, ale naopak, 
svojou popularitou ich zatieòujú \cite{ai_3}.
Genóm v rámci ES je zlo¾ený z~génov, ktoré sú reprezentované reálnymi èíslami,
z~èoho vyplýva implementaèná diferenciácia genetických operátorov.
% toto az do operatorov??, Gaussova funkcia - termin OK ?
Mutaèný operátor je väè¹inou implementovaný pomocou pripoèítania hodnoty podµa Gaussovej
funkcie. Takýto spôsob mutácie rie¹i jeden problém genetických algoritmov, ktorý znie:
malé zmeny genotypu nemusia vies» k~malým zmenám fenotypu\footnote{
Tento problém sa dá obís» napríklad pomocou Grayovho kódovania,
v ktorom sa ka¾dé dve po sebe idúce hodnoty lí¹ia v bitovom vyjadrení len
na jednej pozícii.}.



% GENETICKE OPERATORY
%%%%%%%%%%%%%%%%%%%%%
\section{Evoluèné operátory}
% popisat zrejme v skratke aj operatory pre permutacny genotyp
% ujasnit si, ako popisat selekciu a obnovu populacie - pouzivaju
% sa podobne techniky (koleso stastia, najlepsi vyhrava, elitizmus),
% pri ciastocnej obnove sa pouzivaju techniky rulety etc. - aspon spomenut

% uvazovat selekciu ako geneticky operator ??
% gen. opratory su mutacia s krizenie, selekcia je tiez operator, ale nie geneticky


% trochu dlhsie pojednanie o genetickych operatoroch
Evoluèné procesy z~biológie boli aplikované a~svojím spôsobom
interpretované v~teórii evoluèných algoritmov.
Ide o~pekný príklad medzioborového transféru informácií.
V evoluènom procese je nutná znaèná variácia genómu, ktorá 
je zabezpeèovaná rekombinaènými (genetickými) operátormi.
Následný výber najlep¹ích jedincov reprezentuje operátor selekcie.


% odkazy na obrazky: \ref{obr:krizenia}, \ref{obr:mutation}


%%% SELEKCIA
\emph{Selekcia} je evoluèný operátor, ktorý urèuje, ktoré rie¹enie v~populácii rie¹ení
pre¾ije, a~ktoré nie. Reprezentuje prirodzený výber popísaný Darwinom.
Rozoznávame 3~najpou¾ívanej¹ie typy selekcie a ich varianty \cite{hynek_ga_gp}:

\begin{itemize}
	\item {\bf Koleso ¹»astia}\,--\,jednotlivým jedincom sa priradí pravdepodobnos» výberu do~ïal¹ej
	generácie na~základe hodnoty fitness funkcie, \uvoz{lep¹í} jedinci budú vyberaný s~vy¹¹ou pravdepodobnos»ou.

	\item {\bf Turnaj}\,--\,je zalo¾ený na~náhodnom výbere $n$-tíc jedincov a ich súboji, v~ktorom sú
	zbraòami hodnoty fitness funkcie, ví»az je vo~väè¹ine variant tejto selekcie vybraný do~ïal¹ej
	generácie v¾dy, no mô¾e by» vyberaný s~pravdepodobnos»ou men¹ou ne¾ 1.

	\item {\bf \uvoz{Najlep¹í vyhráva}}\,--\,je najjednoduch¹ím typom selekcie, v ka¾dej generácii preferuje
	len tých najstatnej¹ích jedincov, jedincov umiestnených na~èelných prieèkach rebríèka zostavovaného
	komisiou, ktorá hodnotí statnos» jedinca na~základe hodnoty fitness funkcie.
	Popisovaný spôsob výberu je vhodný v prípade, keï fitness funkcia nemá veµa extrémov, preto¾e evoluèné
	algoritmy zalo¾ené na~tomto type selekcie nevedia rie¹i» tzv. klamné problémy a~multimodálne funkcie,
	preto¾e v~populácii sa nezachováva diverzita jedincov, hodnôt fitnes funkcie.
	Evoluèné algoritmy zalo¾ené na~tomto type selekcie èastkrát predbe¾ne konvergujú, 
	uviaznu v lokálnom extréme fitness funkcie.
\end{itemize}


Pri praktických aplikáciach je len málokedy mo¾né sa stretnú» s~urèitým typom selekcie v základnej podobe,
takmer v¾dy sa pou¾ívajú ich mo¾né variácie a~kombinácie.
Pre priblí¾enie, existujú aj prístupy, ktoré pracujú s~dvoma populáciami kvôli zachovaniu rôznorodosti
populácie a~dochádza k~migrácii medzi populáciami.
Ka¾dá populácia je v¹ak zalo¾ená na~inej fitness funkcii \cite{park_dual_pop}.
So~selekciou úzko súvisí obnova populácie. Po vyhodnotení hodnôt fitness funkcie jedincov
populácie a~selekcii jedincov, ktorí \uvoz{pre¾ijú}, máme viac mo¾ností ako nahradi»
aktuálnu populáciu. Rozli¹ujeme 2~základné prístupy:

\begin{itemize}
	\item {\bf Úplná obnova populácie}\,--\,dochádza k~vymieraniu rodièov, teda celá generácia je nahradená novou.
	\item {\bf Èiastoèná obnova populácie} (steady state)\,--\,potomkami sa nahradi len urèitá èas» jedincov.
\end{itemize}


% KRIZENIE
% rekombinacia je krizenie + mutacia ??
\emph{Krí¾enie} je základným rekombinaèným operátorom, pomocou ktorého
sa mie¹a genetická informácia 2~jedincov.
Rôzne techniky krí¾enia majú spoloènú tú vlastnos»,
¾e ide v¾dy o~vzájomnú výmenu èastí chromozómov.
V~niektorých prípadoch mô¾e by» v¹ak potrebné a~u¾itoèné da» jedincom
mo¾nos» pre¾i» bezo zmeny a~uchova» pre~budúcu populáciu kópie rodièovských jedincov.
Preto sa operátor krí¾enia aplikuje s~istou pravdepodobnos»ou
a~v~ostatných prípadoch sú za~potomkov rodièovského páru prehlásené ich priame kópie.
Pravdepodobnos» pou¾itia operátoru krí¾enia
je obvykle relatívne vysoká (0,75--0,95 \cite{control_parameters}).
Krí¾enie umo¾òuje rýchlu výmenu relatívne veµkého mno¾stva genetickej informácie
a~do~znaènej miery ovplyvòuje efektívnos» evoluèného algoritmu \cite{hynek_ga_gp}.
K~tomuto operátoru mo¾no pristupova» viacerými spôsobmi 
(vizuálna podoba je zobrazená na~obrázku \ref{obr:krizenia}):



\begin{itemize}
	\item {\bf $N$-bodové krí¾enie}\,--\,najpou¾ívanej¹í typ krí¾enia, väè¹inou sa pou¾íva
	krí¾enie jednobodové alebo dvojbodové, závisí samozrejme na~danom probléme a~veµkosti
	chromozómu.
	\item {\bf Krí¾enie maskou}\,--\,náhodne sa vygeneruje bitová maska, ktorej då¾ka je zhodná
	s~då¾kou chromozómu a~noví jedinci sa tvoria tak, ¾e gény na~pozíciach obsahujúcich \uvoz{0}
	zdedí prvý potomok a~gény na~pozíciach obsahujúcich \uvoz{1} zdedí potomok druhý.
	\item {\bf Aritmetické krí¾enie}\,--\,vyu¾íva sa najmä pri~evoluèných stratégiach, kde sú
	gény reprezentované reálnymi èíslami, noví jedinci sa tvoria na~základe aplikácie
	nejakého aritmetického operátoru (väè¹inou priemer) na~gény rodièov.
\end{itemize}




\begin{figure}[h]
\centering
\subfloat[1-bodové krí¾enie]{\label{obr:krizenia:1}\includegraphics[width=70mm]{fig/ea/cross_1bod}} \ \ \ \
\subfloat[2-bodové krí¾enie]{\label{obr:krizenia:2}\includegraphics[width=70mm]{fig/ea/cross_2bod}} \ \ \ \
\\
\subfloat[Krí¾enie maskou]{\label{obr:krizenia:3}\includegraphics[width=70mm]{fig/ea/cross_mask}} \ \ \ \
\subfloat[Aritmetické krí¾enie (pomocou priemeru)]{\label{obr:krizenia:4}\includegraphics[width=70mm]{fig/ea/cross_arit}}
\caption{Rôzne typy evoluèného operátoru krí¾enia, prevzaté z \cite{brigant_2011}.}
\label{obr:krizenia}
\end{figure}


% MUTACIA
% permutacne chromozomy
%Operátor mutácie je zalo¾ený na~náhodnej zmene génu chromozómu jedinca.
%mutácia zabezpeèuje vznik nových vlastností, zmenu génov. 
Operátor \emph{mutácie} väè¹inou veµmi jednoduchým spôsobom a s relatívne malou pravdepodobnos»ou
(0,001--0,05 \cite{control_parameters})
náhodne mení hodnotu jednotlivých génov.
V prípade binárneho kódovania to konkrétne znamená,
¾e vybraný gén v danom chromozóme zmení svoju hodnotu z nuly na jednotku a naopak.
Slú¾i ako nástroj, ktorý bráni príli¹ rýchlemu \uvoz{zjednotvárneniu} vlastností v rámci populácie,
strate u¾itoèného genetického materiálu a predèasnej konvergencie populácie \cite{hynek_ga_gp}.
Rozli¹ujeme v~zásade 2 typy mutácie
(ilustruje obrázok \ref{obr:mutation}):


\begin{itemize}
	\item {\bf Inverzia génu}\,--\,vhodné a~pou¾itelné len pri binárnej reprezentácii
	génov, teda génov, ktoré mô¾u existova» len v~2 navzájom rôznych alelách.
	\item {\bf Pripoèítanie hodnoty rozlo¾enia pravdepodobnosti}\,--\,vyu¾íva sa
	pri~reprezentácii génov reálnymi èíslami, k~hodnote génu sa pripoèíta hodnota
	daná urèitým rozdelením pravdepodobnosti.
\end{itemize}


\begin{figure}[h]
\begin{center}
  \scalebox{0.4}{\includegraphics{fig/ea/mutacia.png}}
  \caption{Mutácia genómu, µavá èas» obrázku reprezentuje aplikáciu
  operátoru mutácie pomocou inverzie génu,
  pravá èas» pomocou pripoèítania hodnoty rozlo¾enia pravdepodobnosti.}
  \label{obr:mutation}
\end{center}
\end{figure}


% popis permutacnych chromozomov
©pecificky definované chromozómy jedincov si vy¾adujú ¹pecifické operátory krí¾enia
a mutácie. Roz¹írené je tzv. \emph{permutaèné kódovanie} kandidátneho rie¹enia.
Vyu¾íva sa väè¹inou pri problémoch, kedy je rie¹ením permutácia urèitých hodnôt.
Podrobne ¹tudovaným je napríklad problém obchodného cestujúceho\footnote{
Problém obchodného cestujúceho (angl. Travelling Salesman Problem)
je optimalizaèný problém nájdenia najkrat¹ej mo¾nej cesty prechádzajúcej
v¹etkými zadanými bodmi na mape. Matematicky ide o nájdenie Hemiltonovskej cesty v grafe $G$ s najni¾¹ou
cenou $C$.}.
Mutácia takto zakódovaných jedincov sa najèastej¹ie rie¹i prehodením hodnôt dvoch náhodne vybraných génov
mutovaného chromozómu.
Alternatívnym prístupom je obrátenie podsekvencie chromozómu (angl. Reverse Sequence Mutation),
kedy sa vezme dvomi náhodne vygenerovanými pozíciami obmedzená podsekvencia chromozómu
a poradie génov v sekvencii sa otoèení \cite{tcp_gen_operators}.
Krí¾enie je zlo¾itej¹ie, existujú 3 najpou¾ívanej¹ie prístupy \cite{tcp_gen_operators} 
(pre zamedzenie konfúzii sú ponechané ich originálne anglické názvy):


\begin{itemize}
	\item {\bf Order 1 crossover (OX)}\,--\,náhodne sa vygenerujú body krí¾enia, gény medzi bodmi
	krí¾enia 1. rodièa sa skopírujú do potomka, následne sa postupne prechádzajú jednotlivé gény 
	2. rodièa (od 2. bodu krí¾enia) a do potomka sa kopírujú len tie gény, ktoré sa nenachádzajú
	v èasti medzi bodmi krí¾enia 1. rodièa.
	
	\item {\bf Partially-mapped crossover (PMX)}\,--\,
	náhodne sa vygenerujú body krí¾enia, gény medzi bodmi krí¾enia 1. rodièa
	sú skopírované do potomka.
	Prechádzamjú sa gény medzi bodmi krí¾enia 1. rodièa zµava doprava,
	aktuálny gén sa \uvoz{spojí} s protiµahlým génom a s génom
	s rovnakou hodnotou v 2. rodièovi.
	Ak protiµahlý gén nemá rovnakú hodnotu ako aktuálny, skopírujú sa tieto 2 gény a prehodia ich pozície,
	následné sa postupným posunom doprava tento algoritmus opakuje.
	Následne sa do potomka skopírujú len tie gény z 2. rodièa,
	ktoré sú mimo body krí¾enia, prièom sa zachováva pozícia génov.
	V poslednom kroku sa prechádzajú jednotlivé gény 2. rodièa, zaèína sa génom
 za 2. bodom krí¾enia a do potomka sa kopírujú tie gény, ktorých hodnota sa nenachádza v èasti medzi
 bodmi krí¾enia 1. rodièa alebo v potomkovi.
	
	\item {\bf Cycle crossover (CX)}\,--\,
	krí¾enie sa zaèína s génom na 1. pozícii 1. rodièa (alebo na~inej ¹tartovacej pozícii) 
	a skopíruje sa na 1. pozíciu potomka. 
	Potomok teda nemô¾e dedi» 1. gén z 2. rodièa, tak¾e tento gén musí by» vyhµadaný
	v 1. rodièovi a skopírovaný do potomka.
	 Nech tento gén má pozíciu $x$ v 1. rodièovi.
	 Potom je zdedený potomkom na pozícii $x$ a nemô¾e by» teda zdedený od 2. rodièa.
	 Tento proces sa opakuje, kým sa nevytvorí cyklus, teda kým sa nedosiahne gén, ktorý u¾ potomok zdedil.
	 Potom sa vyberie gén z 2. rodièa, a vytvorí sa analogicky cyklus, tentokrát v¹ak
	 potomok dedí gény 2. rodièa. Nevýhodou tohto prístupu mô¾e by» to, ¾e podsekvencie dedených génov
	 nemusia by» súvislé.
\end{itemize}
