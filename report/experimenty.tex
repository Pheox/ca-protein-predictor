\chapter{Korektor PSIPREDu}\label{exps}


% popis datasetov, vlastnosti, predspracovanie etc.
Primárnou snahou experimentovania s navrhnutým modelom bolo zlep¹i» úspe¹nos» 
jedného v súèasnosti najlep¹ích nástrojov, PSIPRED-u.
Dôle¾itá je vhodná parametrizácia modelu, pre ktorej dosiahnutie
bola najskôr vykonaná optimalizácia
parametra veµkosti okolia, ktoré uva¾uje prechodová funkcia CA.
Následne bol zistený optimálny maximálny poètet krokov CA, 
ktoré mô¾u pri evolúcii pravidla CA jednotlivé rie¹enia nadobúda».
Po nájdení najvhodnej¹ích hodnôt týchto 2 parametrov
boli vykonané experimenty predikujíce sekundárnu ¹truktúru proteínu 
v spolupráci s nástrojom PSIPRED.
Uva¾ované boli 2 varianty:
\begin{enumerate}
	\item Primárna predikcia pomocou navrhnutého systému CASSP
a následná oprava nie príli¹ vierohodných predikcii pomocou 
nástroja PSIPRED.
	\item Primárna predikcia pomocou nástroja PSIPRED 
	a následná oprava nie príli¹ vierohodných predikcií 
	pomocou navrhnutého systému CASSP.
\end{enumerate}

\noindent Implementované sú 2 spôsoby opravy predikcie primárneho prediktora:
\begin{enumerate}
	\item Pou¾itie predikcie sekundárneho prediktora pre reziduum,
	ktorého vierohodnos» predikcie je ni¾¹ia ne¾ zadaný prah.
	\item Pou¾itie predikcie sekundárneho prediktora pre celú proteínovú sekvenciu,
	ak priemerná vierohodnos» reziduí v rámci opravovanej sekvencie je ni¾¹ia
	ne¾ zadaný prah.
\end{enumerate}

V oboch prípadoch je dôle¾ité správne stanovi» prah opravy primárnej predikcie pomocou
predikcie sekundárnej. Pre zistenie vhodného prahu bola vykonaná jeho optimalizácia pre obe varianty.

Optimálne parametrizované model bol natrénovaný a výsledky porovnané s vybranými
existujúcimi nástrojmi.

% podakovanie
\todo{prepracovat podakovanie}
Umo¾nený prístup k výpoèetným a úlo¾ným zariadeniam vedeckých
skupín prispievajúcich do 
Národnej sie»ovej infra¹truktúry MetaCentrum, vytvorenej v rámci programu
\uvoz{Rozsiahla infra¹truktúra pre projekty výskumu, vývoja a inovácii} (LM2010005),
je vysoko cenený. 

%The access to computing and storage facilities owned by parties and projects contributing 
%to the National Grid Infrastructure MetaCentrum, 
%provided under the programme \uvoz{Projects of Large Infrastructure for Research, 
%Development, and Innovations} (LM2010005) is highly appreciated.


\section{Trénovacie a testovacie dátové sady}\label{sec:datasets}

Ak chceme porovnáva» výkonnos» modelu s inými modelmi, je nutné,
aby úspe¹nosti v¹tkých porovnávaných modelov boli poèítané
na základe rovnakej testovacej dátovej sady. 

V oblasti predikcie sekundárnej ¹truktúry proteínových sekvencií
sú najpou¾ívanej¹ími dátovými sadami pou¾ívanými ako na trénovanie,
tak aj na testovanie, RS126 a CB513.

% nutne vyhodnotenie kvoli porovnaniu aj na datasetoch RS126 a CB513




Uvedené experimenty pracovali s 3 dátovými sadami. 

RS126 \cite{rs_126} - ... 


Porovnávanie úspe¹notí
Dátová sada RS126 bola prvý krát pou¾itá v èlánku Burkharda Rosta 
a Chrisa Sandera z roku 1993 \cite{rs_126}.
Podµa ich slov ide o nehomológnu dátovú sadu, nehomológnos»
definovali tak, ¾e ¾iadne 2 proteiny v dátovej sade nesmú ma» viac ne¾
25 \% zhody v sekvenciách pri ich då¾ke viac ne¾ 80 reziduí.
Nevýhodou (okrem malého poètu sekvencií) je ¾e dátová sada RS15 obsahuje
páry proteínových sekvencií, ktoré sú nepochybne podobné pri provnávaní
sofistikovanej¹ími metódami ne¾ obyèajnou percentouálnou zhodou. 
Navy¹e, výpoèet percentuálnej zhody je závislý ako na då¾ke zarovnania,
tak aj na zlo¾ení sekvencií.
Tak¾e, 2 sekvencie podobného, ale nezvyèajného aminokyselinového zlo¾enia,
mô¾u ma» vysokú percentuálnu zhodu, aj keï sú nehomológne/unrelated \cite{cb_513}.
% historicke datove sady na: http://bioinformatics.biol.uoa.gr/historical/



\todo{cb513}

Dátovú sada CB513 uviedli páni Barton a Cuff vo svojej ¹túdii z roku 1999 \cite{cb_513}.

Na¹»astie, existujú techniky, ktoré nemajú nevýhody obyèajnej percentuálnej zhody.
Príkladom mô¾e by» metóda, ktorá najskôr zarovná sekvencie ¹tandardným
algoritmom dynamického programovania (napríklad algoritmus Needleman-Wunsch)
a pre toto zarovnanie sa získa skóre.

Poradie aminokyselín v ka¾dej proteínovej sekvencii je randomizovaný
a následne je vykonané zarovnanie pomocou spomínaného dynamického
programovania takejto pomie¹anej sekvencie. Tento proces je opakovaný
typicky aspoò 100 krát a priemer a smerodatná odchýlka jednotlivých skóre.
is calculated.

$SD$ alebo $Z$ skóre porovnania je dané nasledovne: $(V - \bar{x})/\sigma$.

Z poèiatoènej dátovej sady sa odstránili multisegmentové domény,
odstránené boli aj sekvencie, ktorých ¹truktúry získané pomocou
röntgenovej kry¹talografie nemali dostatoèné rozlí¹enie (2,5 \AA).

Následne boli vyhodené sekvencie podobné s nejakou sekvenciou
z dátovej sady RS126 pri podobnosti $SD >= 5$.

Sekvencie, ktoré nemali úplnú DSSP definíciu boli taktie¾ odstránené.
Následne bola prefiltrovaná dátová sada spojená s RS126.
Miera podobnosti nie je schopná zachyti» v¹etky homológne sekvencie,
na ïal¹ie porovnávanie sekvencií bol pou¾itý algoritmus SCOP \cite{scop}.
Výsledkom je dátová sada CP513.

Chou-Fasmanove koeficienty a konformaèné koeficienty 
pre nejednoznaèné aminokyseliny (B,Z,X) boli nahradené priemernými hodnotami,
pre B je to priemer priemer hodnôt aminokyseliny asparagín a kyseliny asparagovej,
pre Z priemer hodnôt aminokyseliny glutamín a kyseliny glutámovej, 
pre J priemer hodnôt aminokyseliny leucín a izoleucín. 


\todo{pdb\_vyber}
% TODO - postup spracovania, odkial sa sekvencie/data stahovali, ake boli problemy,
% ktore sekvencie boli vynechane etc.

Tre»ou pou¾itou dátovou sadou je celkom rozsiahly subset pribli¾ne 5300
proteínových sekvencií.
Zoznam proteínových sekvencií bol vytvorený .... \cite{pdb_vyber}.

Získanie sekvencií pomocou webovej slu¾by MRS \cite{mrs_web_service}.
V niektorych sekvenciach nahradene o za C, u za C (\todo{warum??}).
% vyhody nevyhody oproti RS a CB ??
Vzhµadom k rozsiahlosti dátovej sady bola v kontexte tejto práce vyu¾ívaná
iba na testovanie.

% vlastny popis datovej sady pdb_vyber
% nazvat dat. sadu PDBselect ?
PDBselect je zoznam reprezentatívnych proteínovych sekvencií
s nizkou mutúal/základnou sekvenènou podobnos»ou/identitiou

PDBselect (http://bioinfo.tg.fh-giessen.de/pdb
select/) is a list of representative protein chains
with low mutual sequence identity selected from
the protein data bank (PDB) to enable unbiased statistics.
The list increased from 155 chains in 1992 to
more than 4500 chains in 2009. PDBfilter-select is an





Keï¾e vývoj v oblasti bioinformatiky je veµmi rýchly a poèet záznamom
v PDB rastie exponenciálne, mo¾no pova¾ova» databázy RS126 a CB513
za zastaralé a pre reálne praktické pou¾itie by sa siahlo po nov¹ej,
viac aktualizovanej databáze. 
No pre základnú charakteristiku navrhnutého modelu sú tieto 2 dátové sady
dostaèujúce, navy¹e, takmer v¹etky nástroje predikcie sekundárnej ¹truktúry
spomenuté v kapitole \ref{predikcia} pracujú práve s týmito dátovými sadami,
tak¾e je mo¾né priame porovnanie úspe¹nosti.



% predpocitanie predikcii PSIPRED pre trenovanie !
Pri trénovaní modelu, ktorý predikuje sekundárnu ¹truktúru proteínu
v spolupráci s nástrojom PSIPRED, a vzhµadom k pomerne vysokej èasovej zlo¾itosti
tohto nástroja (viï obrázok \ref{obr:psipred_time}), 
boli PSIPRED predikcie v¹etkách sekvencií dátových sád predpoèítané.


\begin{figure}[h]
\begin{center}
  \scalebox{0.8}{\includegraphics{pics/psipred_time.jpg}}
  \caption{meeeh}
  \label{obr:psipred_time}
  \end{center}
\end{figure}







\section{Okrajové podmienky a inicializácia modelu}



\todo{okrajove podmienky salanda}

Pri modelovaní javov pomocou celulárneho automatu je dôle¾itá
definícia okrajových podmienok - podmienok, ktoré popisujú
situácie, kedy okolie aktuálnej bunky nie je kompletné, teda
na okrajov automatu.
Je vhodné definova» bunky mimo celulárneho automatu
pomocou novovytvorených aminokyselín s optimálnymi vlastnos»ami
z pohµadu úspe¹nosti predikcie. Práca \cite{salanda_2012} sa urèením takejto
aminokyseliny zaoberala a pri¹la s výsledkom optimálnej
aminokyseliny X300, ktorej vlastnosti sú nasledovné:

% TODO: zobrazit aj tabulku najlepsich ?? - budu stacit snad len vlastnosti optimalnej pseudo-aminokyseliny




\todo{inicial. modelu - na zaklade Gaussovej funkcie - normalizovanej}
napisat presnu rovnicu gaussovej funkcie + asi aj obrazok pre ilustraciu

Na inicializácii jedincov/chromozómov v rámci evoluèného algoritmu v podstate
nezále¾í, no pre rýchlos» konvergencie je dôle¾ité sa zaobera» aj touto èas»ou systému.
Je intuitívne jasné, ¾e vplyv reziduí v tesnom okolí predikovanej aminokyseliny
bude vy¹¹í ne¾ vplyv reziduí vzdialenej¹ích.
Platí to najmä pri motívoch alpha helixu, no beta sheety asto vznikajú
globálnou interakciou, ktorú by sa mal pokúsi» emulova» navrhnutá model
celulárneho automatu.

Navrhnutá je inivializácia váh/vplyvu jednotlivých  okolitých reziduí na základe
normalizovanej Gaussovej funkcie pre strednú hodnotu $\mu = 0$
a smerodatnú odchýlku $\sigma = 0.399$ (hodnota $f(0) \doteq 1$):

\begin{eqnarray}
\frac{1}{\sigma\sqrt{2\pi}} e^{\frac{-(x-\mu)^2}{2\sigma^2}}
\end{eqnarray}




\section{Metodika vyhodnocovania úspe¹nosti}
% kratke pojednanie o sposobe vyhodnocovania vysledkov

Pri korektnom popise prediktora je veµmi dôe¾itý spôsob vyhodnocovania jeho úspe¹nosti.

Azda najdôle¾itej¹ou podmienkou je, aby trénovacie a testovacie dáta nekorelovali, (unbiased),
èo je »a¾ké dosiahnu» v reálnych podmienkach, kedy dát èasto nie je dostatok
a ich rozlo¾enie je neznáme.

Na mieste je teda otázka, ako ideálne rozdeli» dátovú sadu na trénovaciu a testovaciu tak,
aby sme získali èo mo¾no najdôveryhodnej¹iu hodnotu úspe¹nosti?

Simone Borra a Agostino Di Ciaccio vo svojej práci \cite{borra_10kcv} do¹li k záveru, ¾e 10-fold cross-validácia
pre vy¹¹í poèet vzorkov ne¾ 100, vykazuje najvernej¹iu hodnotu chyby prediktoru pre reálne dátové sady.
It is known that K-fold CV is biased estimate of Err and that by increasing the number of folds we can reduce
the bias. 
Leave-One-Out cross-validácia (LOO) teoreticky vykazuje lep¹í/unbiased výsledok, no pri testovaní
vzhµadom k tomu, ¾e testovacia dátová sada obsahuje iba 1 prvok, sa prejavuje veµká variabilita,
èo robí problémy pri selekcii najlep¹ieho ïielèieho modelu.
1O-fold cross-validácia bude teda pou¾itá
pre vyhodnocovanie jednotlivých modelov. Cross-validácia bude spustená x-krát a spriemerovaná pre získanie e¹te
hodnovernej¹ej hodnoty.




\section{Optimálna veµkos» okolia CA}
.. experiment zis»ujúci optimálnu veµkos» okolia celulárneho automatu


\section{Maximálny poèet krokov CA}


\section{Predikcia v spoluprácii s nástrojom PSIPRED}
blah...


\subsection{PSIPRED ako hlavný prediktor}
optimálna hodnota prahu...



\subsection{PSIPRED ako sekundárny prediktor}
optimálna hodnota prahu

