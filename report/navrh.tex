\chapter{Návrh predikèného systému}\label{navrh}
% zakladny model (z clanku Chopry), mierne upraveny model - diplomka Salanda
\todo{nazvy kapitol}


% uviest co som vylepsil oproti spominanym clankom, co som pridal,
% co som naopak abstrahoval
Navrhnutý systém z~veµkej èasti vychádza z~dvoch prác venujúcich
sa SSP s vyu¾itím CA \cite{chopra_2007} \cite{salanda_2012}.
Modifikované sú tie èasti systému, ktoré majú potenciál zlep¹i»
úspe¹nos» predikcie SSP. Ide hlavne o~spôsob klasifikácie
jednotlivých reziduí do jednej z troch motívov sekundárnej ¹truktúry proteínov.
\todo{trochu rozviest}

% tupy popis mojho systemu
Predikèným modelom je celulárny automat, ktorého prechodová funkcia
bola suboptimálne parametrizovaná pomocou evoluèných algoritmov, konkrétne
evoluèných stratégii.

Boli navrhnuté 2 prechodové funkcie. Prvá je zhodná s prechodovou funkciu
vytvorenou Choprom a spol., no bola implementovaná najmä kvôli porovnávaniu
v experimentálnej fáze.
Druhou je metóda vyu¾ívajúca jednak klasické Chou-Fasmanove koeficienty, druhak
tzv. konformaèné koeficienty. Ide tie¾ o ¹tatistický popis pravdepodobnosti výskytu
urèitej aminokyseliny v urèitom konformaènom stave resp. motíve sekundárnej ¹truktúry.

Významnou je experimentálna èas» práce, ktorá sa zameriava na:
\begin{itemize}
	\item experimentálne zistenie optimálnej veµkosti okolia, ktoré bude vyu¾íva» prechodová
	funkcia celulárneho automatu, podµa práce pánov .. .. by mal by» limit veµkosti okolia 17
	(8 vµavo, 8 vpravo), kedy sa úspe¹nos» signifikantne nezvy¹uje ...cite...
	\item
\end{itemize}




Aby sa predikèný model mal o~èo oprie», definujeme ¹tatistické
%(sekcia \ref{sec:stat_popis}) a~experimentálne (sekcia \ref{sec:stat_exp})
vlast\-nos\-ti reziduí.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{©tatistický popis reziduí}\label{sec:stat_popis}
% nie je dobry 1-riadkovy odstavec

©tatistika je veda, pomocou ktorej na~základe empirických
dát získavame nové znalosti.
V~návrhu systému budú vyu¾ité 2~¹tatistické vlastnosti
aminokyselín, Chou--Fasmanove parametre,
ktoré aminokyseliny charakterizujú z~pohµadu miery výskytu
v~ur\-èi\-tom motíve sekundárnej ¹truktúry,
a~konformaèná analýza,
ktorá klasifikuje jednotlivé aminokyseliny pre~konkrétny
motív sekundárnej ¹truktúry do~urèitej konformaènej triedy
na~základe toho, v~akej èasti motívu sekundárnej ¹truktúry
sa príslu¹ná aminokyselina nachádza.


\subsection{Chou-Fasmanove parametre}
% tu popisat len parametre, metodu ako taku v kapitole predikcia
% algoritmus Chou-Fasman: http://prowl.rockefeller.edu/aainfo/chou.htm

Jednou z~metód predikcie SSP 1. generácie je Chou-Fasmanova metóda,
bli¾¹ie popísaná v~sekcii \ref{sec:klasif_pred}.
V~ich práci z~roku 1974 \cite{chou_fasman_parameters} je definovaný
tzv. parameter konformaènej pre\-feren\-cie aminokyseliny $j$
ku~konformaènému stavu~$i$, Chou-Fasmanov parameter $P_j^i$:

\begin{eqnarray}
P_j^i = \frac{f_j^i}{\langle f_j^i\rangle}\label{eq:chou_fasman},
\end{eqnarray}
kde $f_j^i$ je relatívna frekvencia aminokyseliny $j$ v~konformaènom
stave~$i$ daná vz»ahom \ref{eq:chou_fasman_rel_freq} a~$\langle f_j^i\rangle$
priemerná relatívna frekvencia konformaèného stavu $i$ v rámci v¹etkých aminokyselín
vyjadrená vz»ahom \ref{eq:chou_fasman_priem_rel_freq}.


\begin{eqnarray}
f_j^i = \frac{n_j^i}{n^i}\label{eq:chou_fasman_rel_freq}
\end{eqnarray}
kde $n_j^i$ je poèet reziduí $j$ v konformaènom stave $i$
a~$n^i$ je celkový poèet reziduí v konformaènom stave $i$.

\begin{eqnarray}
\langle f_j^i \rangle = \frac{\sum\limits_{\forall k\, \epsilon\, AK} f_k^i}{n_j}\label{eq:chou_fasman_priem_rel_freq}
\end{eqnarray}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Konformaèné triedy}
% tabulku konformacnych klasifikacii pridat do priloh pre obe datove sady ??

Na základe práce Guang-Zheng Zhanga a~spol. \cite{zhang_huang_cc_2005}
definujeme konformaènú triedu pre~v¹etky aminokyseliny
a~v¹etky konformaèné stavy (H, E, C).
Nech $P = p_1, p_2,\dots, p_n$ je primárna ¹truktúra proteínu (sekvencia aminokyselín)
a~$S = s_1, s_2, \dots, s_n$ odpovedajúca sekundárna ¹truktúra proteínu då¾ky~$n$.
Ak $s_i$ a~$s_{i+1}$ sú rôzne konformaèné stavy,
napríklad $s_i = H $ a~$s_{i+1} = B$, hovoríme o~tzv. ¹truktúrnom prechode
(ST\footnote{Z angl. Structure Transition.}),
v~tomto prípade $ST_{HB}$.
Týmto spôsobom mô¾eme definova» ostatných 5~¹truktúrnych prechodov:
$ST_{HC}$, $ST_{BH}$, $ST_{BC}$, $ST_{CH}$ a $ST_{CB}$.

Na základe uvedených ¹truktúrnych prechodov definujeme konformaènú prefe\-ren\-ciu
ami\-nokyse\-lín pre~urèitý motív sekundárnej ¹truktúry.
©truktúrny prechod $ST_{HB}$ mô¾eme chápa» ako ukonèenie H
a~súèasne ako zaèiatok~B.
V~kontexte v¹etkých 6~ST, poèet v¹etkých ukonèení a~zaèiatkov
H urèíme nasledovne:

\begin{eqnarray}
N_{\alpha\text{-ukon\v{c}enie}} = N_{ST_{HB}} + N_{ST_{HC}}\\
N_{\alpha\text{-za\v{c}iatok}} = N_{ST_{BH}} + N_{ST_{CH}}
\end{eqnarray}

kde $N(\cdot)$ reprezentuje poèet rôznych ¹truktúrnych prechodov.
Poèet ukonèení a~zaèiatkov B a~C sa urèí analogicky.
Definujeme konformaènú preferenciu $CP$ ukonèenia resp. zaèiatku
urèitého konformaèného stavu aminokyseliny~$i$,
konkrétne $CP_{j, \alpha\text{-ukon\v{c}enie}}$, $CP_{j, \alpha\text{-za\v{c}iatok}}$,
$CP_{j, \beta\text{-ukon\v{c}enie}}$, $CP_{j, \beta\text{-za\v{c}iatok}}$,
$CP_{j, \text{Coil}-\text{ukon\v{c}enie}}$ a $CP_{j, \text{Coil}\text{-za\v{c}iatok}}$.
Výpoèet $CP_{j, \alpha\text{-ukon\v{c}enie}}$ (ostatné konformaèné
preferencie sa získajú analogicky):

\begin{eqnarray}
CP_{j, \alpha\text{-ukon\v{c}enie}} = \frac{P_{j, \alpha\text{-ukon\v{c}enie}}}{P_{j}}
\end{eqnarray}

kde $P_{j, \alpha\text{-ukon\v{c}enie}}$ a $P_{j}$ sa získa nasledovne:

\begin{eqnarray}
P_{j, \alpha\text{-ukon\v{c}enie}} = \frac{N_{j, \alpha\text{-ukon\v{c}enie}}}{
    \sum_{i=1}^{20} N_{i, \alpha\text{-ukon\v{c}enie}}
}
\end{eqnarray}

kde $N_{j,\alpha\text{-ukon\v{c}enie}}$ vyjadruje poèet reziduí ukonèujúcich H.

\begin{eqnarray}
P_j = \frac{N_j}{N}
\end{eqnarray}

kde $N_j$ vyjadruje celkový poèet reziduí aminokyseliny $j$
a~$N$ celkový poèet reziduí.
Uva¾ujúc reziduum $j$ a~jeho motív sekundárnej ¹truktúry,
$\alpha$-helix (H), definujeme konformaènú triedu (CC)
konformaèného stavu rezidua $j$ (obdobne mo¾no vyjadri» konformaèné
triedy pre~B a~C):

\begin{eqnarray}
CC_{j,\alpha} = \left\{
    \begin{array}{ll}
    b & \text{ak}\ \ CP_{j, \alpha\text{-ukon\v{c}enie}} \geq 1
    \ \wedge\  CP_{j, \alpha\text{-za\v{c}iatok}} \ \, < 1  \\
    f & \text{ak}\ \ CP_{j, \alpha\text{-za\v{c}iatok}} \ \, \geq 1
    \ \wedge\  CP_{j, \alpha\text{-ukon\v{c}enie}} < 1 \\
    n & \text{inak} \\
    \end{array} \right.
\end{eqnarray}

Pou¾ité znaky $b, f, n$ znaèia v~tomto poradí triedy
$Breaker$, $Former$ a $Neutral$.
Konformaèná klasifikácia rezidua $j$ je vyjadrená 3-znakovým
kódom -- $CC_{j,\alpha}CC_{j,\beta}CC_{j,Coil}$.
% nieco v tom zmysle, ze konformacne triedy pre jednotlive
% aminokyseliny a datove sady su v prilohe


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Experimentálny popis reziduí}\label{sec:stat_exp}
% kratke pojednanie o chemickych shiftoch - nedat do teoretickej casti ?

%5.1.2013 bol publikovaný èlánok, ktorý predikuje
%sek. ¹truktúru na základe chemických \uvoz{shiftov} \cite{mechelke_chem_shifts},
%existuje databáza VASCO, èo by vy¾adovalo BLAST + pick do VASCO,
%to do SEP dáva» nebudem,
%keï budem ma» ostatné experimenty hotové, mô¾em vyskú¹a» aj so shiftami.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Pou¾itý celulárny automat}

Sekvenciu aminokyselín proteínov reprezentuje 1\,D CA, ktorého
bunky modelujú jednotlivé reziduá aminokyselín.
Bunky mô¾u nadobúda» 1 z 3 stavov (H, E, C).
Veµkos» okolia nie je pevná, evoluèný algoritmus zis»uje optimálny rádius.
% a experimentálne
©tatistické vlastnosti aminokyselín sú
modelované parametrami buniek CA.
V rámci inicializácie sú ka¾dej bunke pridelené
Chou-Fasmanove koeficienty, ktoré sú
pri prechode do ïal¹ej konfigurácie CA upravované.
Aktualizovaná je aj konformaèná trieda buniek
na základe tabuµky definovanej pre konkrétnu dátovú sadu.
% aminokyselin


\subsection{Prechodová funkcia}

My¹lienkou prechodovej funkcie je výpoèet preferencie bunky/aminokyseliny
výskytu v~urèitom konformaènom stave na~základe príslu¹nej
konformaènej triedy $CC^i_j$ a~hodnôt parametrov vychádzajúcich
z~Chou-Fasmanových parametrov $P^i_{j}$, CF parametrov:

\begin{eqnarray}
P^i_{t+1,j} = \frac{\sum\limits^o_{k=-o} w_k P^i_{j-k}}{\sum\limits^o_{k=-o}w_k}
\end{eqnarray}

$P^i_{t+1,j}$ vyjadruje CF parameter bunky $j$ v~èase $t+1$ pre~konformaèný
stav $i$, ktorý je váhovaným súètom jednotlivých CF parametrov $P^i_{j-k}$
v~okolí $o$.
Vlastná prechodová funkcia má tvar:

% funkcia nepokryva pociatocne stavy S, S_0 !?
\begin{eqnarray}
S_{t+1,j} = \max{R^i_{t+1,j}} \ \ \ i\, \epsilon\, \{H, E, C\}
\end{eqnarray}


kde $S_{t+1,j}$ je stav bunky $j$ v~èase $t+1$
a~parameter $R^{i}_{t+1,j}$ vyjadruje mieru
príslu¹nosti bunky resp. amino\-kyse\-liny $j$ v~kroku $t+1$
ku~konformaènému stavu $i$ (H, E, C):
\begin{eqnarray}
R^i_{t+1,j} = P^i_{t+1,j} + \alpha\cdot CC^i_j
\end{eqnarray}

kde $\alpha$ je koeficient miery závislosti stavu bunky
na~konformaènej triede $CC^i_j$ optimalizovaná evoluèným algoritmom.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Pou¾itý evoluèný algoritmus}

EA, konkrétne evoluèná stratégia (ES), je aplikovaná
na optimalizáciu prechodovej funkcie CA.
Evolvovaný chromozóm má tvar:

\begin{eqnarray}
C = [s,\alpha,r,w_{-r}, w_{-r+1},\dots,w_{r-1},w_r]
\end{eqnarray}

kde $s$ vyjadruje poèet krokov EA, $\alpha$ signifikantnos»
konformaènej triedy na stav bunky a teda na úspe¹nos»
predikèného modelu, $r$ veµkos» okolia
a $w_i$ pre $i\,\epsilon\, \{-r, \dots, r\}$ váhy
jednotlivých buniek okolia.


%
%\noindent Ideje návrhu:
%\begin{itemize}

%    \item Chopra\cite{chopra_2007} odporúèa pár vylep¹ení:
%    \begin{itemize}
%        \item nelineárna update formula
%        \item sofistikovanej¹ia aktivaèná funkcia (MAX)
%        \item additional residue information
%    \end{itemize}

%    \item pou¾itie nelineárnej klasifikaènej metódy,
%    napr. kvadratická logistická regresia, ?kernel regresia?

%    \item výpoèet tzv. konformaènej triedy pre ka¾dú aminokyselinu
%    (Zhang, Huang 2005 \cite{zhang_huang_cc_2005})
%\end{itemize}



% asi by bolo vhodne kratke pojednanie o zmenach oproti 2 referencnym clankom
%\section{Zhrnutie inovácií}


